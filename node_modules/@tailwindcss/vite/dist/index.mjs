var V=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),q=r=>{throw TypeError(r)};var P=(r,e,i)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&q("Object expected");var n,f;i&&(n=e[V("asyncDispose")]),n===void 0&&(n=e[V("dispose")],i&&(f=n)),typeof n!="function"&&q("Object not disposable"),f&&(n=function(){try{f.call(this)}catch(h){return Promise.reject(h)}}),r.push([i,n,e])}else i&&r.push([i]);return e},B=(r,e,i)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(a,p,d,g){return g=Error(d),g.name="SuppressedError",g.error=a,g.suppressed=p,g},f=a=>e=i?new n(a,e,"An error was suppressed during disposal"):(i=!0,a),h=a=>{for(;a=r.pop();)try{var p=a[1]&&a[1].call(a[2]);if(a[0])return Promise.resolve(p).then(h,d=>(f(d),h()))}catch(d){f(d)}if(i)throw e};return h()};import{compile as z,env as J,Features as C,Instrumentation as x,normalizePath as I}from"@tailwindcss/node";import{clearRequireCache as K}from"@tailwindcss/node/require-cache";import{Scanner as M}from"@tailwindcss/oxide";import{Features as D,transform as _}from"lightningcss";import L from"node:fs/promises";import w from"node:path";var v=J.DEBUG,$=/[?&](raw|url)\b/;function H(){let r=[],e=null,i=!1,n=!1,f=new F(()=>new Set),h=new M({}),a=new F(s=>{let t=e.createResolver({...e.resolve,extensions:[".css"],mainFields:["style"],conditions:["style","development|production"],tryIndex:!1,preferRelative:!0});function l(u,m){return t(u,m,!0,i)}let c=e.createResolver(e.resolve);function o(u,m){return c(u,m,!0,i)}return new A(s,()=>f,e.base,l,o)});function p(s,t,l,c){let o=!1;for(let u of h.scanFiles([{content:t,extension:l}]))o=!0,f.get(s).add(u);o&&d(c)}function d(s){for(let t of r){let l=[];for(let[c,o]of a.entries()){let u=t.moduleGraph.getModuleById(c);if(!u){if(o.builtBeforeTransform)continue;s||a.delete(c);continue}a.get(c).requiresRebuild=!1,t.moduleGraph.invalidateModule(u),l.push({type:`${u.type}-update`,path:u.url,acceptedPath:u.url,timestamp:Date.now()})}l.length>0&&t.hot.send({type:"update",updates:l})}}async function g(s,t,l){let c=s.lastContent,o=await s.generate(c,t,l);if(o===!1)return;v&&l.start("Optimize CSS");let u=O(o,{minify:n});return v&&l.end("Optimize CSS"),u}async function b(s,t,l){let c={...s,getCombinedSourcemap:()=>{throw new Error("getCombinedSourcemap not implemented")}};for(let o of e.plugins){if(!o.transform||o.name.startsWith("@tailwindcss/"))continue;if(o.name.startsWith("vite:")&&o.name!=="vite:css"&&o.name!=="vite:css-post"&&o.name!=="vite:vue")continue;if(o.name==="ssr-styles")continue;let u="handler"in o.transform?o.transform.handler:o.transform;try{let m=await u.call(c,l,t);if(!m)continue;typeof m=="string"?l=m:m.code&&(l=m.code)}catch{console.error(`Error running ${o.name} on Tailwind CSS output. Skipping.`)}}return l}return[j(a),{name:"@tailwindcss/vite:scan",enforce:"pre",configureServer(s){r.push(s)},async configResolved(s){e=s,n=e.build.cssMinify!==!1,i=e.build.ssr!==!1&&e.build.ssr!==void 0},transformIndexHtml(s,{path:t}){p(t,s,"html",i)},transform(s,t,l){let c=G(t);U(t)||p(t,s,c,l?.ssr??!1)}},{name:"@tailwindcss/vite:generate:serve",apply:"serve",enforce:"pre",async transform(s,t,l){var m=[];try{if(!U(t))return;let c=P(m,new x);c.start("[@tailwindcss/vite] Generate CSS (serve)");let o=a.get(t);o.builtBeforeTransform&&(o.builtBeforeTransform.forEach(R=>this.addWatchFile(R)),o.builtBeforeTransform=void 0);if(T(t))return s;l?.ssr||await Promise.all(r.map(R=>R.waitForRequestsIdle(t)));let u=await o.generate(s,R=>this.addWatchFile(R),c);if(!u)return a.delete(t),s;return{code:u}}catch(S){var E=S,y=!0}finally{B(m,E,y)}}},{name:"@tailwindcss/vite:generate:build",apply:"build",enforce:"pre",async transform(s,t){var u=[];try{if(!U(t))return;let l=P(u,new x);l.start("[@tailwindcss/vite] Generate CSS (build)");let c=a.get(t);c.builtBeforeTransform&&(c.builtBeforeTransform.forEach(y=>this.addWatchFile(y)),c.builtBeforeTransform=void 0);if(T(t))return s;let o=await c.generate(s,y=>this.addWatchFile(y),l);if(!o)return a.delete(t),s;return{code:o}}catch(m){var S=m,E=!0}finally{B(u,S,E)}},async renderStart(){var t=[];try{let s=P(t,new x);s.start("[@tailwindcss/vite] (render start)");for(let[u,m]of a.entries()){if(T(u))continue;let S=await g(m,()=>{},s);if(!S){a.delete(u);continue}await b(this,u,S)}}catch(l){var c=l,o=!0}finally{B(t,c,o)}}}]}function G(r){let[e]=r.split("?",2);return w.extname(e).slice(1)}function U(r){if(r.includes("/.vite/"))return;let e=G(r);return(e==="css"||e==="vue"&&r.includes("&lang.css")||e==="astro"&&r.includes("&lang.css")||T(r))&&!$.test(r)}function T(r){return G(r)==="svelte"&&r.includes("&lang.css")}function O(r,{file:e="input.css",minify:i=!1}={}){function n(f){return _({filename:e,code:f,minify:i,sourceMap:!1,drafts:{customMedia:!0},nonStandard:{deepSelectorCombinator:!0},include:D.Nesting,exclude:D.LogicalProperties|D.DirSelector,targets:{safari:16<<16|1024,ios_saf:16<<16|1024,firefox:8388608,chrome:7274496},errorRecovery:!0}).code}return n(n(Buffer.from(r))).toString()}function W(r){return w.resolve(r.replace(/\?.*$/,""))}var F=class extends Map{constructor(i){super();this.factory=i}get(i){let n=super.get(i);return n===void 0&&(n=this.factory(i,this),this.set(i,n)),n}},A=class{constructor(e,i,n,f,h){this.id=e;this.getSharedCandidates=i;this.base=n;this.customCssResolver=f;this.customJsResolver=h}lastContent="";builtBeforeTransform;compiler;requiresRebuild=!0;scanner;candidates=new Set;dependencies=new Set;basePath=null;overwriteCandidates=null;async generate(e,i,n){this.lastContent=e;let f=W(this.id),h=w.dirname(w.resolve(f));if(!this.compiler||!this.scanner||this.requiresRebuild){K(Array.from(this.dependencies)),this.dependencies=new Set([W(f)]),v&&n.start("Setup compiler"),this.compiler=await z(e,{base:h,shouldRewriteUrls:!0,onDependency:d=>{i(d),this.dependencies.add(d)},customCssResolver:this.customCssResolver,customJsResolver:this.customJsResolver}),v&&n.end("Setup compiler");let p=(this.compiler.root==="none"?[]:this.compiler.root===null?[]:[this.compiler.root]).concat(this.compiler.globs);this.scanner=new M({sources:p})}if(!(this.compiler.features&(C.AtApply|C.JsPluginCompat|C.ThemeFunction|C.Utilities)))return!1;if(!this.overwriteCandidates||this.compiler.features&C.Utilities){v&&n.start("Scan for candidates");for(let p of this.scanner.scan())this.candidates.add(p);v&&n.end("Scan for candidates")}if(this.compiler.features&C.Utilities){for(let p of this.scanner.files)i(p);for(let p of this.scanner.globs){if(p.pattern[0]==="!")continue;let d=w.relative(this.base,p.base);d[0]!=="."&&(d="./"+d),d=I(d),i(w.posix.join(d,p.pattern));let g=this.compiler.root;if(g!=="none"&&g!==null){let b=I(w.resolve(g.base,g.pattern));if(!await L.stat(b).then(t=>t.isDirectory(),()=>!1))throw new Error(`The path given to \`source(\u2026)\` must be a directory but got \`source(${b})\` instead.`);this.basePath=b}else g===null&&(this.basePath=null)}}this.requiresRebuild=!0,v&&n.start("Build CSS");let a=this.compiler.build(this.overwriteCandidates?this.overwriteCandidates:[...this.sharedCandidates(),...this.candidates]);return v&&n.end("Build CSS"),a}sharedCandidates(){if(!this.compiler)return new Set;if(this.compiler.root==="none")return new Set;let e=/^[A-Z]:/,i=f=>this.basePath===null||f.startsWith(this.basePath)?!0:e.test(f)?!1:!f.startsWith("/"),n=new Set;for(let[f,h]of this.getSharedCandidates())if(i(f))for(let a of h)n.add(a);return n}};function j(r){return{name:"@tailwindcss/svelte",api:{sveltePreprocess:{async style({content:e,filename:i,markup:n}){var g=[];try{if(!i)return;let f=P(g,new x);v&&f.start("[@tailwindcss/vite] Preprocess svelte");let h=i+"?svelte&type=style&lang.css";let a=r.get(h);a.requiresRebuild=!0;a.builtBeforeTransform=[];let p=new M({});a.overwriteCandidates=p.scanFiles([{content:n,file:i,extension:"svelte"}]);let d=await a.generate(e,l=>a.builtBeforeTransform?.push(l),f);if(!d){r.delete(h);return}return{code:d}}catch(b){var s=b,t=!0}finally{B(g,s,t)}}}}}}export{H as default};
